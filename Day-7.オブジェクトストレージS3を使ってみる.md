# Day 7. オブジェクトストレージS3を使ってみる

## アプリケーションからの利用

### バケット

バケット名は世界でユニーク。アカウントでユニークではない。

### アクセスキー

IAMユーザーに作成したアクセスキー（認証情報）をバッチサーバーに設定する。

```
$ aws configure
AWS Access Key ID [None]: <ここにアクセスキーID>
AWS Secret Access Key [None]: <ここに秘密アクセスキー>
Default region name [None]: ap-northeast-1 ← 東京リージョン
Default output format [None]: json ← とりあえず
```

名前をつけずに設定した場合`default`としてプロファイルを利用できる。アプリケーションはこのプロファイルを指定することS3にアクセスできる（アプリケーションはアクセスキーIDや秘密アクセスキーを必要としない）。

## 静的ホスティング

バケットのプロパティから設定（有効化）する。

また、バケットポリシーエディターで次を入力する。

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadForGetBucketObjects",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::<バケット名>/*"
        }
    ]
}
```

「新規のパブリックバケットポリシーをブロックする」を外しておかないとパブリックなアクセス権限を設定できない。

さらに、「バケットにパブリックポリシーがある場合、パブリックアクセスとクロスアカウントアクセスをブロックする」を外しておかないと、アップロードしたファイルがパブリックにならない。