# Day 6. Elastic Load Balancer（ELB）を用いてWebレイヤの可用性を高める

## ELB

### ALBとNLBとCLB

<dl>
  <dt>
    ALB: Application Load Blancer
  </dt>
  <dd>
    L7層でロードバランシングする。HTTPやHTTPSなど。
  </dd>
  <dt>
    NLB: Network Load Blancer
  </dt>
  <dd>
    L4層でロードバランシングする。TCP。
  </dd>
  <dt>
    CLB: Classic Load Blancer
  </dt>
  <dd>
    上記のどちらも対応できるが古いサービス。使わない。
  </dd>
</dl>

### Auto Scaling

条件を決めてEC2の数を増減させる。CPU使用率や時間などを条件にできる。

## 構築

### 自動割り当てIP設定の変更

サブネットで起動するインスタンスに自動的にパブリックIPアドレスをリクエストするように設定する。

### セキュリティグループ

webとして立てているEC2とはセキュリティグループが異なるので新規に作成する。sshがない。

### ターゲットグループ

ヘルスチェックの条件やリクエストを振り分ける先のインスタンスを設定する。ターゲットグループはELB作成の中で合わせて作成する。ターゲットグループはひとつのロードバランサーのみに関連づけることができる。

オートスケーリングするときは手動で登録したインスタンスを削除しておく方が分かりやすい。

### 起動設定

どのイメージ、どのインスタンスタイプで起動するか設定する。

### Auto Scaling グループ

最小インスタンス数やスケーリングポリシーなどを設定する。

「パブリック IP アドレスは割り当てられません」は気にしなくてよい。サブネットにその設定を済ませてある。

ヘルスチェックのタイプはELBにする。